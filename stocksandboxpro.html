<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Stock Sandbox Pro - Market Simulator</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Outfit:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/stocksandboxpro.css">
</head>
<body>
  <!-- Animated background -->
  <div class="particles" id="particles"></div>
  <canvas class="bg-canvas" id="bgCanvas"></canvas>
  
  <!-- Auto-save indicator -->
  <div class="save-indicator" id="saveIndicator">
    <span class="save-icon">üíæ</span>
    <span id="saveText">Auto-saved</span>
  </div>
  
  <!-- RS Productions Splash -->
  <div class="rs-splash" id="rsSplash">
    <div class="rs-particles" id="rsParticles"></div>
    <div class="rs-content">
      <div class="rs-title">
        <span class="rs-letter">R</span><span class="rs-letter">S</span>
      </div>
      <div class="rs-subtitle">Productions</div>
      <div class="rs-tagline">An RS Productions' Game</div>
    </div>
  </div>
  
  <!-- Loading Screen -->
  <div class="loading-screen" id="loadingScreen">
    <div class="loading-content">
      <div class="loading-logo">STOCK SANDBOX PRO</div>
      <div class="loading-bar">
        <div class="loading-progress" id="loadingProgress"></div>
      </div>
      <div class="loading-text" id="loadingText">Initializing market data...</div>
    </div>
  </div>

  <div class="app" id="app">
    <header>
      <div class="header-grid">
        <div class="logo-section">
          <div class="logo">STOCK SANDBOX</div>
          <div class="logo-subtitle">Pro Edition</div>
        </div>
        
        <div class="balances">
          <div class="balance balance-clickable" id="cashBalance" title="Click for full amount">
            <div class="balance-icon">üíµ</div>
            <div class="balance-info">
              <div class="balance-label">Cash</div>
              <div class="balance-value" id="cash">$0.00</div>
            </div>
          </div>
          <div class="balance balance-clickable" id="portfolioBalance" title="Click for full amount">
            <div class="balance-icon">üìä</div>
            <div class="balance-info">
              <div class="balance-label">Portfolio</div>
              <div class="balance-value" id="portfolio">$0.00</div>
            </div>
          </div>
          <div class="balance balance-clickable highlight" id="totalBalance" title="Click for full amount">
            <div class="balance-icon">üí∞</div>
            <div class="balance-info">
              <div class="balance-label">Total Value</div>
              <div class="balance-value" id="total">$0.00</div>
            </div>
          </div>
        </div>
        
        <div class="header-actions">
          <button class="btn btn-icon" id="helpBtn" title="Keyboard Shortcuts (?)">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
              <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
          </button>
          <button class="btn btn-icon" id="quickBuyBtn" title="Quick Buy (Ctrl+B)">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 5v14M5 12h14"></path>
            </svg>
          </button>
          <button class="btn btn-icon" id="portfolioChartBtn" title="Portfolio Chart (Ctrl+P)">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
            </svg>
          </button>
          <button class="btn btn-icon" id="settingsBtn" title="Settings (Ctrl+,)">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M12 1v6m0 6v6m8.66-15.66l-4.24 4.24m-4.24 4.24l-4.24 4.24m15.66-8.66l-4.24-4.24m-4.24-4.24l-4.24-4.24"></path>
            </svg>
          </button>
          <button class="btn btn-primary" id="viewHoldingsBtn" title="My Holdings (Ctrl+H)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:6px">
              <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
              <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
            </svg>
            Holdings
          </button>
          <button class="btn btn-secondary" id="resetBtn" title="Reset Progress">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:6px">
              <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
              <path d="M21 3v5h-5"></path>
              <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
              <path d="M3 21v-5h5"></path>
            </svg>
            Reset
          </button>
          <div class="status-indicator">
            <span class="status-dot"></span>
            <span id="marketStatus">Loading...</span>
          </div>
        </div>
      </div>
    </header>

    <div class="main-grid">
      <div class="stocks-panel">
        <div class="panel-header">
          <h2 class="panel-title">Market Overview</h2>
          <div class="panel-badges">
            <span class="badge">250+ Symbols</span>
            <span class="badge accent" id="marketTrendBadge">Neutral</span>
          </div>
        </div>
        
        <div class="search-wrapper">
          <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
          <input type="text" class="search" id="search" placeholder="Search stocks by symbol or name..." />
          <button class="search-clear" id="searchClear" style="display:none">√ó</button>
        </div>
        
        <div class="filter-tabs">
          <button class="filter-tab active" data-filter="all">All Stocks</button>
          <button class="filter-tab" data-filter="watchlist">‚≠ê Watchlist</button>
          <button class="filter-tab" data-filter="owned">üìà Owned</button>
          <button class="filter-tab" data-filter="crypto">‚Çø Crypto</button>
          <button class="filter-tab" data-filter="gainers">üî• Top Gainers</button>
          <button class="filter-tab" data-filter="losers">üìâ Top Losers</button>
        </div>
        
        <div class="stock-list" id="stockList"></div>
      </div>

      <div class="sidebar">
        <div class="stats-panel">
          <h2 class="panel-title">Quick Stats</h2>
          <div class="stat-grid">
            <div class="stat">
              <div class="stat-icon gain">üìà</div>
              <div class="stat-info">
                <div class="stat-label">Top Gainer</div>
                <div class="stat-value gain" id="topGainer">--</div>
              </div>
            </div>
            <div class="stat">
              <div class="stat-icon loss">üìâ</div>
              <div class="stat-info">
                <div class="stat-label">Top Loser</div>
                <div class="stat-value loss" id="topLoser">--</div>
              </div>
            </div>
            <div class="stat">
              <div class="stat-icon">üìä</div>
              <div class="stat-info">
                <div class="stat-label">24h Change</div>
                <div class="stat-value" id="dayChange">+0.00%</div>
              </div>
            </div>
            <div class="stat">
              <div class="stat-icon">üèÜ</div>
              <div class="stat-info">
                <div class="stat-label">All-Time High</div>
                <div class="stat-value" id="allTimeHigh">$100.00</div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="performance-panel">
          <h2 class="panel-title">Performance</h2>
          <div class="mini-chart-wrapper">
            <canvas class="mini-chart" id="miniChart"></canvas>
          </div>
          <div class="performance-stats">
            <div class="perf-stat">
              <span class="perf-label">Today</span>
              <span class="perf-value" id="perfToday">+0.00%</span>
            </div>
            <div class="perf-stat">
              <span class="perf-label">Total Return</span>
              <span class="perf-value" id="perfTotal">+0.00%</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div class="modal-overlay" id="settingsModal">
    <div class="modal modal-wide">
      <div class="modal-header">
        <h2 class="modal-title">‚öôÔ∏è Settings</h2>
        <button class="close-btn" id="closeSettingsModal">√ó</button>
      </div>
      
      <!-- Themes Section -->
      <div class="settings-section">
        <h3 class="settings-section-title">üé® Themes</h3>
        <div class="theme-grid" id="themeGrid"></div>
      </div>
      
      <!-- Market Simulation Section -->
      <div class="settings-section">
        <h3 class="settings-section-title">üìä Market Simulation</h3>
        <div class="settings-grid">
          <div class="form-group">
            <label class="form-label">Market Volatility</label>
            <select class="form-select" id="volatilitySetting">
              <option value="low">Low - Stable market</option>
              <option value="medium" selected>Medium - Normal swings</option>
              <option value="high">High - Wild swings</option>
              <option value="insane">Insane - Extreme chaos</option>
              <option value="irresponsible">Irresponsible - Complete mayhem</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">Market Trend Bias</label>
            <select class="form-select" id="trendBiasSetting">
              <option value="down-only">Down Only - Bear trap</option>
              <option value="bearish">Bearish - Downward pressure</option>
              <option value="neutral" selected>Neutral - Balanced</option>
              <option value="bullish">Bullish - Upward momentum</option>
              <option value="up-only">Up Only - Bull run</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">Market Crash Frequency</label>
            <select class="form-select" id="crashFrequencySetting">
              <option value="never" selected>Never - Safe mode</option>
              <option value="very-rare">Very Rare - Once in a blue moon</option>
              <option value="rare">Rare - Occasionally</option>
              <option value="occasional">Occasional - Regular risk</option>
              <option value="frequent">Frequent - High risk</option>
              <option value="very-frequent">Very Frequent - Constant danger</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">Recovery Speed</label>
            <select class="form-select" id="recoverySpeedSetting">
              <option value="incredibly-slow">Incredibly Slow</option>
              <option value="slow">Slow</option>
              <option value="normal" selected>Normal</option>
              <option value="fast">Fast</option>
              <option value="incredibly-fast">Incredibly Fast</option>
              <option value="almost-instant">Almost Instant</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">Retail Trader Influence</label>
            <div class="toggle-group">
              <span class="toggle-label">Add market noise from retail traders</span>
              <label class="toggle-switch">
                <input type="checkbox" id="retailInfluenceSetting">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Auto-Refresh Interval</label>
            <select class="form-select" id="refreshIntervalSetting">
              <option value="2000">2 seconds - Hyper-speed</option>
              <option value="5000">5 seconds - Fast</option>
              <option value="10000" selected>10 seconds - Normal</option>
              <option value="30000">30 seconds - Slow</option>
            </select>
          </div>
        </div>
      </div>
      
      <!-- Account Section -->
      <div class="settings-section">
        <h3 class="settings-section-title">üíæ Save Data</h3>
        <div class="save-info">
          <p>Your progress is automatically saved to your browser's local storage every 30 seconds.</p>
          <div class="save-stats">
            <div class="save-stat">
              <span class="save-stat-label">Last Saved:</span>
              <span class="save-stat-value" id="lastSavedTime">Never</span>
            </div>
            <div class="save-stat">
              <span class="save-stat-label">Total Sessions:</span>
              <span class="save-stat-value" id="totalSessions">1</span>
            </div>
          </div>
        </div>
      </div>
      
      <div class="modal-footer">
        <button class="btn btn-primary btn-full" onclick="saveSettings()">üíæ Save Settings</button>
        <button class="btn btn-secondary" onclick="resetToDefaults()">‚Ü∫ Reset to Defaults</button>
      </div>
    </div>
  </div>

  <!-- Holdings Modal -->
  <div class="modal-overlay" id="holdingsModal">
    <div class="modal modal-wide">
      <div class="modal-header">
        <h2 class="modal-title">üìä My Holdings</h2>
        <button class="close-btn" id="closeHoldingsModal">√ó</button>
      </div>
      <div class="holdings-summary">
        <div class="summary-stat">
          <div class="summary-label">Total Positions</div>
          <div class="summary-value" id="totalPositions">0</div>
        </div>
        <div class="summary-stat">
          <div class="summary-label">Portfolio Value</div>
          <div class="summary-value" id="portfolioValue">$0.00</div>
        </div>
        <div class="summary-stat">
          <div class="summary-label">Total Return</div>
          <div class="summary-value" id="totalReturn">+0.00%</div>
        </div>
      </div>
      <div class="holdings-grid" id="holdingsList"></div>
    </div>
  </div>

  <!-- Quick Buy Modal -->
  <div class="modal-overlay" id="quickBuyModal">
    <div class="modal">
      <div class="modal-header">
        <h2 class="modal-title">‚ö° Quick Buy</h2>
        <button class="close-btn" id="closeQuickBuyModal">√ó</button>
      </div>
      
      <div class="form-group">
        <label class="form-label">Stock Symbol</label>
        <input type="text" class="form-input" id="quickBuySymbol" placeholder="e.g. AAPL, TSLA, BTC-USD" list="stockSuggestions" />
        <datalist id="stockSuggestions"></datalist>
      </div>
      
      <div class="form-group">
        <label class="form-label">Amount ($)</label>
        <div class="input-with-button">
          <input type="number" class="form-input" id="quickBuyAmount" placeholder="Enter dollar amount" step="0.01" min="0.01" />
          <button class="btn btn-secondary" id="quickBuyMaxBtn">Max</button>
        </div>
      </div>
      
      <div class="quick-buy-preview" id="quickBuyPreview">
        Enter a symbol and amount to see preview
      </div>
      
      <button class="btn btn-primary btn-full" id="executeQuickBuy">‚ö° Execute Buy Order</button>
    </div>
  </div>

  <!-- Portfolio Chart Modal -->
  <div class="modal-overlay" id="portfolioChartModal">
    <div class="modal modal-wide">
      <div class="modal-header">
        <h2 class="modal-title">üìà Portfolio Performance</h2>
        <button class="close-btn" id="closePortfolioChartModal">√ó</button>
      </div>
      
      <div class="chart-wrapper">
        <canvas class="chart-canvas" id="portfolioChartCanvas"></canvas>
      </div>
      
      <div class="chart-stats-grid">
        <div class="chart-stat">
          <div class="chart-stat-label">Starting Value</div>
          <div class="chart-stat-value">$100.00</div>
        </div>
        <div class="chart-stat">
          <div class="chart-stat-label">Current Value</div>
          <div class="chart-stat-value" id="portfolioCurrentValue">$100.00</div>
        </div>
        <div class="chart-stat">
          <div class="chart-stat-label">Total Return</div>
          <div class="chart-stat-value" id="portfolioTotalReturn">+0.00%</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Stock Detail Modal -->
  <div class="modal-overlay" id="stockModal">
    <div class="modal">
      <div class="modal-header">
        <div>
          <h2 class="modal-title" id="modalSym">--</h2>
          <p class="modal-subtitle" id="modalName">--</p>
        </div>
        <button class="close-btn" id="closeStockModal">√ó</button>
      </div>
      
      <div class="chart-wrapper">
        <canvas class="chart-canvas" id="stockCanvas"></canvas>
      </div>
      
      <div class="stock-modal-price">
        <div class="price-section">
          <div class="price-label">Current Price</div>
          <div class="price-value" id="modalPrice">$0.00</div>
        </div>
        <div class="price-section">
          <div class="price-label">Order Total</div>
          <div class="price-value accent" id="modalTotalCost">$0.00</div>
        </div>
      </div>
      
      <div class="trade-controls">
        <div class="trade-input-group">
          <label class="form-label">Quantity</label>
          <input type="number" class="form-input" id="modalQty" step="0.00001" min="0.00001" placeholder="0.00000" />
        </div>
        <div class="trade-buttons">
          <button class="btn btn-secondary" id="modalMaxBuy" title="Buy max with available cash">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 5v14M5 12h14"></path>
            </svg>
            Max Buy
          </button>
          <button class="btn btn-buy" id="modalBuy">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:6px">
              <path d="M9 11l3 3L22 4"></path>
              <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
            </svg>
            Buy
          </button>
          <button class="btn btn-secondary" id="modalMaxSell" title="Sell all shares">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="15" y1="9" x2="9" y2="15"></line>
              <line x1="9" y1="9" x2="15" y2="15"></line>
            </svg>
            Max Sell
          </button>
          <button class="btn btn-sell" id="modalSell">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:6px">
              <polyline points="3 6 5 6 21 6"></polyline>
              <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
            </svg>
            Sell
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast">
    <div class="toast-icon">‚ÑπÔ∏è</div>
    <div class="toast-message"></div>
  </div>

  <script src="js/stocksandboxpro.js"></script>
</body>
</html>
